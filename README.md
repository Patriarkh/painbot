PaintBot — это Telegram-бот для генерации раскрасок на основе текстового описания от пользователя. Бот интегрируется с API OpenAI DALL-E для создания уникальных изображений. Каждый пользователь получает 10 бесплатных генераций при регистрации, а также возможность приобрести дополнительные генерации.

Функционал
1. Регистрация пользователей:

Автоматически регистрирует новых пользователей в базе данных MongoDB при первом взаимодействии.
Каждому пользователю дается 10 бесплатных генераций изображений.

2. Генерация изображений:

Пользователь вводит описание изображения, которое он хочет получить.
Бот генерирует раскраски и отправляет их пользователю.
Отслеживается и обновляется количество оставшихся бесплатных генераций.

3. Функции для администратора:

Возможность отправлять массовые сообщения всем зарегистрированным пользователям.
Логирование запросов и активности для отладки и аналитики.

4. Поддержка:

Возможность связаться с поддержкой через кнопку.
_______________________________________________

Обзор файлов

1. paintbot.py
Главный скрипт бота:
Управляет взаимодействием с пользователем через команды и кнопки.
Обрабатывает регистрацию новых пользователей и отправку интерфейса.
Основные команды:
/start: Приветствие пользователя, регистрация и запуск интерфейса.
/check: Проверка работоспособности бота.
/broadcast: Рассылка сообщений всем пользователям (доступна только администратору).
Клавиатура:
"Получить раскраску": Начинает процесс генерации.
"Поддержка": Предоставляет контактную информацию для связи с поддержкой.

2. db.py
Модуль работы с базой данных:
Управляет подключением к MongoDB через переменные окружения.
Основные функции:
add_user: Добавляет нового пользователя в коллекцию users.
get_user: Получает информацию о пользователе по его chat_id.
update_free_generations: Обновляет количество оставшихся бесплатных генераций для пользователя.

3. image_generator.py
Модуль генерации изображений:
Использует OpenAI DALL-E API для создания раскрасок.
Основные функции:
generate_image_request: Отправляет запрос к API для генерации изображения.
handle_image_generation: Обрабатывает процесс генерации и отправки изображения пользователю и администратору.
generate_image: Проверяет количество генераций и запускает процесс создания изображения.

4. get_id.py
Инструмент для получения file_id:
Позволяет получить идентификатор файла или фото, отправленного в чат.
Используется для загрузки изображений в интерфейс бота.
_______________________________________________

Логика работы бота

1. Запуск:

Пользователь вводит команду /start.
Бот проверяет, зарегистрирован ли пользователь. Если нет — добавляет его в базу данных.
Отправляет приветственное сообщение с интерфейсом (фотографии и кнопки).

2. Генерация раскраски:

Пользователь нажимает кнопку "Получить раскраску".
Бот запрашивает текстовое описание желаемого изображения.
Проверяет доступное количество бесплатных генераций:
Если генерации доступны, запускается процесс создания изображения через OpenAI API.
Если генерации закончились, предлагается связаться с поддержкой.

3. Административные действия:

Администратор может отправить массовое сообщение с помощью команды /broadcast.
Все генерации логируются, а изображения отправляются администратору для контроля.

4. Поддержка:

При нажатии на кнопку "Поддержка" пользователь получает контактные данные для связи.
